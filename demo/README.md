# Демо: React + Vite + activateOnSignalServiceWorker

Минимальное приложение на React и Vite с Service Worker на базе **activateOnSignalServiceWorker** (offline-first + активация по сигналу со страницы).

## Локальный запуск (с SW и офлайном)

Из корня репозитория:

```bash
cd demo && pnpm start
```

Откройте указанный URL (обычно `http://localhost:4173`). В DevTools → Network включите «Offline» и обновите страницу — контент должен отдаваться из кеша.

При каждом запросе `sw.js` сервер отдаёт его с заголовками `Cache-Control: no-store, no-cache`, поэтому браузер при проверке обновлений не использует кеш и получает актуальный скрипт. Сервер при каждом запросе вносит изменения в скрипт, чтобы имитировать изменения сервисворкера.

## Что демонстрируется

- Регистрация SW из приложения (`/sw.js`).
- Пресет `offlineFirst`: precache при `install`, отдача из кеша в `fetch`.
- Плагин `skipWaitingOnMessage`: по сообщению с типом из пакета (`SW_MSG_SKIP_WAITING`, см. `@budarin/http-constants`) со страницы — `skipWaiting`; плагин `claim` в `activate` вызывает `clients.claim()`.
- Кнопка «Применить» отправляет это сообщение **ожидающему** воркеру (`reg.waiting`), после чего он активируется и забирает клиентов.
- Если после «Проверить обновление» кнопка «Применить» не появляется и новая версия сразу активна — в Chrome DevTools (Application → Service Workers) снимите галку **Update on reload**. Для отладки можно открыть консоль у воркера (кнопка «inspect» у SW) и убедиться, что при нажатии «Применить» воркер получает сообщение и активируется.
- Индикатор онлайн/офлайн и статус SW.
